---
title: "Apurva Mahajan - Detroit"
output: html_document
date: "2025-04-22"
---

## Story pitch:

**rsw comment: let's revise to first describe the story pitch. then describe the problems. the two are conflated here and it's hard to follow the significance of what you are pursuing.**

After my initial analysis, I've found that two counties in Michigan --- Oscoda and Keweenaw --- have seen the highest drops in immunization rates for three of the four major vaccine series, and consistently fell in the bottom three for lowest MMR vaccination rates in the state. These two counties also have some of the lowest populations in the state. **RSW COMMENT: tell us why this is significant** I've joined the vaccination report card data to Census ACS data from 2023 on population for each county, and am working on joining election data to this to see if there's a pattern between vaccination rates and how people voted in the 2024 and 2016 elections. I'd like to see the proportion of votes allocated toward the Republican Party and the Democratic Party for each of the counties in Michigan, and I want to perform a more robust analysis for these counties beyond what I found of the two counties that immediately stand out. I also plan on looking at the vaccination rates for the MMR vaccine alone. I've found the csv for this from the Michigan government and will load it in as I continue work on this story.

Some current limitations are that I'm [not sure general population is the best metric to use.]{.underline}**rsw comment: im not following you here. we look at the voting patterns for broader context** I think using the population estimates for children under 18 would provide me more accurate numbers, since the value for immunization coverage itself is based on the proportion of children under a certain age range. But I would like to make my methodology as sound as possible, since certain series could only be recommended for certain age ranges, so I'm planning to come back and do some more research on this. However, there's not much online publicly, so I'm a little stuck until I talk to an expert, such as a Michigan epidemiologist, who can provide me more context on this data, since these vaccine series are only used by the state's department of health and human services.

------------------------------------------------------------------------

**rsw comment: cut these notes below and focus on your project**

~~A demo notebook for Dow Jones News Fund data interns~~

~~During the week's training, you will work on a project called Investigate Your Community to produce detailed story pitches relevant to their summer internship positions. The goal is to have the students research a topic relevant to your newsroom so they can get to work immediately at the internship.~~

~~Here are some examples from last year's DJNF data journalism training:~~

~~Hannah Rosenberger, at ASI Media/Counselor magazine, produced this analysis on name, image and likeness trends: <https://hrosenberger.github.io/ASI-NIL-Project/>~~

~~Shifra Dayak, an intern at the Connecticut Mirror, produced this analysis of environment spill data: <https://shifradayak.github.io/DJNF_Merrill/ct_env_spills.html>.~~

~~Michael Zhang, an intern at the Houston Landing, explored local election data: <https://michaelzhangreporter.github.io/Houston_Campaign_Finance/>~~

~~Here's what your newsroom suggested for a project:~~

**rsw comment: integrate the underlined material below into your narrative and code**

[Wondering if you could explore trends of our vaccination rates, especially considering we're dealing with measles here.https://www.detroitnews.com/story/news/local/michigan/2025/04/24/michigan-headed-toward-worst-year-for-measles-in-decades-chief-medical-exec-says/83214966007/]{.underline}

[This website explains the different Series numbers for the sets of vaccines: <https://www.michigan.gov/mdhhs/adult-child-serv/childrenfamilies/immunizations/data-statistics/countyimmsreportcards>]{.underline}

[If you or our intern have any questions, you can contact Lynn Sutfin at the Michigan Department of Health and Human Services at [SutfinL1\@michigan.gov](mailto:SutfinL1@michigan.gov){.email}.]{.underline}

[Background info: There have been 9 reported measles cases this year in Michigan, in Ingham, Kent, Macomb, Marquette, Montcalm and Oakland Counties.]{.underline}

[This notebook helps you get started]{.underline}

# Load software libraries

```{r}
#install.packages("tidyverse")
#install.packages("janitor")
#install.packages("readxl")
#install.packages("rvest")
#install.packages("tidycensus")

library(tidyverse)
library(janitor)
library(readxl)
library(rvest)
library(tidycensus)


```

# Load data + initial cleaning

```{r}

# The report card data provides estimates for immunization coverage at the county level for vaccines recommended for children (19-35 months) and adolescent (13-17-year-olds)

# load in vaccine report card data
report_card_data <- read.csv("../data/Report_card_All_data_20250313.csv") |> 
    clean_names()

# How many counties?
report_card_data$cntyname %>% 
  unique()
# Michigan has 83 counties. There are 85 unique county values, because this data set includes Detroit City and the State of Michigan's vaccination report cards.

# I'm creating a column based on an index so I can plot this and analyze by time. 

#rsw comment: do you really need to have 76 columns at this point? can you narrow it down?

report_card_data <- report_card_data %>% 
  mutate(
     quarter_num = as.numeric(sub("Q", "", quarter)),
     quarter_index = year + (quarter_num - 1) / 4,
    quarter_date = make_date(year, (quarter_num - 1) * 3 + 1, 1)
  )

```

# Percent change analysis for four childhood vaccination series over the past decade

#rsw comment: break out each one of these, provide an english translation for each of the vaccine series 4313314 = "a polio vaccine" and display them using a datatable

datatable(DF, caption = "XXXX", options = list(pageLength = 20))

```{r}
### PERCENT CHANGE IN VACCINATION COVERAGE

##rsw comment: define 4313314, 43133142, 132321, 1323213. editors will have no idea what you're talking about

# For this analysis, I'm focusing on the vaccine series 4313314, 43133142, 132321, 1323213, and the MMR vaccine. These are the series Michigan recommends for children and adolescents. 


#### 4313314 SERIES ####
# Let's look at the 4313314 series: "4 or more doses of DTaP/DTP/DT, 3 or more doses of Polio, 1 or more dose of MMR, 3 or more doses of Hib, 3 ore more doses of HepB, 1 or more dose of Varicella, 4 or more doses of PCV." 

# Coverage for the 4313314 vaccine decreased for all but three counties in Michigan. Oscoda and Keweenaw Counties nearly halved their vaccine coverage for this series. 

#rsw comment - so how many people are not vaccinated for polio now by county?

report_card_data %>% 
  group_by(cntyname) %>% 
  filter(quarter_index %in% c(2014.75, 2024.75)) %>% 
  select(cntyname, quarter_index, covg4313314) %>% 
  pivot_wider(
    names_from = quarter_index,
    values_from = covg4313314,
    names_prefix = "Q_"
  ) %>% 
  mutate(pct_change_2014_2024 = 100 * (Q_2024.75 - Q_2014.75) / Q_2014.75) %>% 
  arrange(pct_change_2014_2024)

 
#### 43133142 SERIES ####
## Again, Oscoda and Keweenaw are in the top two counties that have nearly halved their vaccine coverage for this series.
report_card_data %>% 
  group_by(cntyname) %>% 
  filter(quarter_index %in% c(2014.75, 2024.75)) %>% 
  select(cntyname, quarter_index, covg43133142) %>% 
  pivot_wider(
    names_from = quarter_index,
    values_from = covg43133142,
    names_prefix = "Q_"
  ) %>% 
  mutate(pct_change_2014_2024 = 100 * (Q_2024.75 - Q_2014.75) / Q_2014.75) %>% 
  arrange(pct_change_2014_2024)


#### 132321 SERIES ####
##This series did not have as high percent change decreases, but Keewenaw is in the top five here too. 
report_card_data %>% 
  group_by(cntyname) %>% 
  filter(quarter_index %in% c(2014.75, 2024.75)) %>% 
  select(cntyname, quarter_index, covg132321) %>% 
  pivot_wider(
    names_from = quarter_index,
    values_from = covg132321,
    names_prefix = "Q_"
  ) %>% 
  mutate(pct_change_2014_2024 = 100 * (Q_2024.75 - Q_2014.75) / Q_2014.75) %>% 
  arrange(pct_change_2014_2024)

#### 1323213 SERIES ####
# Nearly all counties have increased their coverage of this series. I'm wondering the reason behind this, and if it is significant. Could this change be because this is a new vaccine series that only started being implemented recently? Would love to talk to a Michigan epidemiologist who works for the state DHHS or some other expert to understand this. 
report_card_data %>% 
  group_by(cntyname) %>% 
  filter(quarter_index %in% c(2014.75, 2024.75)) %>% 
  select(cntyname, quarter_index, covg1323213) %>% 
  pivot_wider(
    names_from = quarter_index,
    values_from = covg1323213,
    names_prefix = "Q_"
  ) %>% 
  mutate(pct_change_2014_2024 = 100 * (Q_2024.75 - Q_2014.75) / Q_2014.75) %>% 
  arrange(pct_change_2014_2024)

```

# Population analysis

#rsw comment: again, these labels need to be in English! covg4313314 etc

```{r}

# Let's look at populations for these counties.

###### DELETE API KEY BEFORE PUSHING!!!!! ######

# Load 2023 ACS population data from tidycensus
vars <- load_variables(2023, "acs1") 

# 2023 Census population by county
pop_by_county <- get_acs(
  geography = "county",
  variables = "B01001A_001",
  state = "MI",
) %>% clean_names()

# Cleaning census data set's names to get rid of extra text like "County"
pop_by_county$name <- sub(" County.*", "", pop_by_county$name)

report_card_with_pop <- report_card_data %>% 
  inner_join(pop_by_county, join_by(cntyname == name)) %>% 
  select(
    cntyname, quarter_index, covg4313314, covg43133142, covg132321, covg1323213, estimate
  )

# Keewenaw is the county with the smallest population, with 2,021 people. 
report_card_with_pop %>%
  filter(quarter_index == "2023.75") %>% 
  group_by(cntyname) %>% 
  arrange(estimate)
# A reason there might be less people getting these vaccine series could potentially be because there are less children in the county? Since this is the least populated county, if children continue to grow up, there may no longer be a need to get these vaccine series. 

# I'm going to re-try the population join, but instead only selecting the population under # Census data on population, election results data dating back to 2016. 

# Checking out the basics of the database. 
# coverage refers to the percent of the population who have the immunization. 



report_card_data %>% 
  filter(cntyname == "Keweenaw") %>% 
  ggplot(aes(x=quarter_index)) +
  geom_line(aes(y = covg4313314, color = "covg4313314")) +
  geom_line(aes(y = covg43133142, color = "covg43133142")) +
  geom_line(aes(y = covg132321, color = "covg132321")) +
  geom_line(aes(y = covg1323213, color = "covg1323213")) +
  labs(title = "Coverage Over Time in Keweenaw County",
       y = "Coverage Value",
       x = "Quarter",
       color = "Coverage Type") +
  theme_minimal()
```

# MMR vaccine analysis

```{r}

# Let's look at MMR vaccination rates as of Dec. 31, 2024 (end of 2024 Q4)

report_card_data %>% 
  filter(
    year == "2024",
    quarter == "Q4"
  ) %>% 
  select(year, quarter, cntyname, covgmmr) %>% 
  arrange(covgmmr) %>% 
  slice(1:10)

report_card_data %>% 
  filter(
    year == "2024",
    quarter == "Q3"
  ) %>% 
  select(year, quarter, cntyname, covgmmr) %>% 
  arrange(covgmmr) %>% 
  slice(1:10)

report_card_data %>% 
  filter(
    year == "2024",
    quarter == "Q2"
  ) %>% 
  select(year, quarter, cntyname, covgmmr) %>% 
  arrange(covgmmr) %>% 
  slice(1:10)

# Oscoda County had the lowest MMR vaccination rates, followed by Keweenaw, Gladwin, Mackinac and Salinac. None of these counties saw measles cases in 2025.


```

# Questions

Write down questions you want answered:

# Potential sources:

Thrishika Bala, epidemiologist for the state of Michigan

# Data Details

Source: <https://www.michigan.gov/mdhhs/adult-child-serv/childrenfamilies/immunizations/data-statistics/countyimmsreportcards>

Documentation: <https://www.michigan.gov/mdhhs/-/media/Project/Websites/mdhhs/Adult-and-Childrens-Services/Children-and-Families/Immunization-Information/LHD/Immunization-Report-Cards/Report_Card_Defs__FAQs_2021.pdf?rev=93e4ac10b66c4c10abcd3c02a6b55982&hash=EA6122E84CB516E9E6D335CC73BDB5CF>
